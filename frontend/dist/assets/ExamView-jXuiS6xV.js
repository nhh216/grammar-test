import{d as y,b as w,e as u,u as c,c as p,F as b,a as e,t as a,n as k,h as A,f as h,i as S,w as q,j as C,k as g,r as I,l as V,o as n}from"./index-BOofV5PH.js";import{u as B}from"./exam-store-4aS1xS3t.js";import{_ as E}from"./QuestionCard.vue_vue_type_script_setup_true_lang-fHmXyX6h.js";import{_ as N}from"./LoadingSpinner.vue_vue_type_script_setup_true_lang-DLzKQwwZ.js";const L={class:"max-w-3xl mx-auto px-4 py-6 sm:py-8 pb-24 sm:pb-8"},R={class:"mb-6"},$={class:"text-2xl font-bold text-gray-900"},z={class:"text-sm text-gray-500 mt-1"},F={class:"mt-2 h-2 bg-gray-200 rounded-full overflow-hidden"},M={class:"space-y-4 mb-8"},T={class:"fixed bottom-0 left-0 right-0 sm:static sm:bottom-auto z-10 bg-white/90 sm:bg-transparent backdrop-blur-sm sm:backdrop-blur-none border-t sm:border-0 border-gray-200 px-4 py-3 sm:p-0"},j={class:"max-w-3xl mx-auto"},D=["disabled"],G={key:2,class:"text-center text-gray-500 py-16"},O=y({__name:"ExamView",props:{sessionId:{}},setup(_){const i=_,s=B(),x=V(),m=C("Đang tải..."),t=g(()=>s.currentSession),r=g(()=>{var l;return((l=t.value)==null?void 0:l.questions.filter(o=>s.userAnswers[o.id]).length)??0});w(async()=>{(!s.currentSession||s.currentSession.id!==i.sessionId)&&await s.fetchSession(i.sessionId)});async function v(){m.value="ChatGPT đang chấm bài và giải thích đáp án...",await s.submitExam(i.sessionId)&&x.push({name:"result",params:{sessionId:i.sessionId}})}return(l,o)=>{const f=I("RouterLink");return n(),u("div",L,[c(s).loading?(n(),p(N,{key:0,message:m.value},null,8,["message"])):t.value?(n(),u(b,{key:1},[e("div",R,[e("h1",$,a(t.value.topic),1),e("p",z,a(r.value)+" / "+a(t.value.questions.length)+" câu đã trả lời ",1),e("div",F,[e("div",{class:"h-full bg-blue-500 transition-all duration-300",style:k({width:`${r.value/t.value.questions.length*100}%`})},null,4)])]),e("div",M,[(n(!0),u(b,null,A(t.value.questions,d=>(n(),p(E,{key:d.id,question:d,selectedAnswer:c(s).userAnswers[d.id],interactive:!0,onAnswer:c(s).setAnswer},null,8,["question","selectedAnswer","onAnswer"]))),128))]),e("div",T,[e("div",j,[e("button",{class:"w-full bg-green-600 text-white py-3 sm:py-3 rounded-xl font-semibold text-base sm:text-lg hover:bg-green-700 disabled:opacity-40 disabled:cursor-not-allowed transition-colors shadow-lg",disabled:r.value<t.value.questions.length,onClick:v}," Nộp bài ("+a(r.value)+"/"+a(t.value.questions.length)+" câu) ",9,D)])])],64)):(n(),u("div",G,[o[1]||(o[1]=h(" Không tìm thấy bài thi. ",-1)),S(f,{to:"/",class:"text-blue-600 underline"},{default:q(()=>[...o[0]||(o[0]=[h("Về trang chủ",-1)])]),_:1})]))])}}});export{O as default};
